@startuml
skinparam componentStyle rectangle
skinparam shadowing false

title Kiến trúc hệ thống (Controllers → Models → Views) - Dựa trên code thực tế

package "Controllers" {
  [AuthController]
  [HomeController]
  [ProductController]
  [CartController]
  [OrderController]
  [OrderStatusController]
  [ProfileController]
  [ReviewController]
  [ReportController]
  [PromotionController]
  [CustomerController]
  [AdminProductController]
  [AdminOrderController]
  [AdminDashboardController]
  [AdminCustomerController]
  [AdminProductController]
  [Auth\ForgotPasswordController]
  [Auth\ForgotPasswordOtpController]
  [Auth\ResetPasswordController]
}

package "Models" {
  [User]
  [Product]
  [Cart]
  [CartItem]
  [Order]
  [OrderItem]
  [Payment]
  [Review]
  [OrderLog]
}

package "Views (Blade)" {
  [layouts.app]
  [home]
  [products.index]
  [product_detail]
  [cart]
  [cart.checkout]
  [orders.index]
  [orders.show]
  [orders.waiting]
  [order_status.index]
  [profile.edit]
  [admin.layout]
  [admin.dashboard]
  [admin.products.index]
  [admin.products.create]
  [admin.products.edit]
  [admin.orders.index]
  [admin.orders.show]
  [admin.customers.index]
  [admin.customers.show]
  [admin.customers.order-history]
  [admin.reports.sales]
  [admin.reports.products]
  [admin.reports.customers]
  [auth.login]
  [auth.register]
  [auth.forgot-password]
  [auth.reset-password]
  [auth.forgot-password-otp-email]
  [vendor.pagination.simple-default]
}

' --- Controller -> Model
[AuthController] --> [User]
[HomeController] --> [Product]
[ProductController] --> [Product]
[CartController] --> [Cart]
[CartController] --> [CartItem]
[CartController] --> [Product]
[OrderController] --> [Order]
[OrderController] --> [OrderItem]
[OrderController] --> [Payment]
[OrderStatusController] --> [Order]
[ProfileController] --> [User]
[ReviewController] --> [Review]
[AdminProductController] --> [Product]
[AdminOrderController] --> [Order]
[AdminDashboardController] --> [Order]
[AdminCustomerController] --> [User]
[ReportController] --> [Order]
[PromotionController] --> [Promotion]
[CustomerController] --> [User]

' --- Controller -> View (returns)
[HomeController] --> [home]
[ProductController] --> [products.index]
[ProductController] --> [product_detail]
[ProductController] --> [admin.products.index]
[ProductController] --> [admin.products.create]
[CartController] --> [cart]
[CartController] --> [cart.checkout]
[OrderController] --> [orders.index]
[OrderController] --> [orders.show]
[OrderController] --> [orders.waiting]
[OrderStatusController] --> [order_status.index]
[ProfileController] --> [profile.edit]
[AdminDashboardController] --> [admin.dashboard]
[AdminProductController] --> [admin.products.index]
[AdminProductController] --> [admin.products.create]
[AdminProductController] --> [admin.products.edit]
[AdminOrderController] --> [admin.orders.index]
[AdminOrderController] --> [admin.orders.show]
[AdminCustomerController] --> [admin.customers.index]
[AdminCustomerController] --> [admin.customers.show]
[AdminCustomerController] --> [admin.customers.order-history]
[ReportController] --> [admin.reports.sales]
[ReportController] --> [admin.reports.products]
[ReportController] --> [admin.reports.customers]
[AuthController] --> [auth.login]
[AuthController] --> [auth.register]

' --- Model relationships
[User] "1" -- "*" [Cart] : owns
[Cart] "1" -- "*" [CartItem] : contains
[Product] "1" -- "*" [CartItem] : referenced-by
[Order] "1" -- "*" [OrderItem] : includes
[Product] "1" -- "*" [OrderItem] : referenced-by
[Order] "1" -- "1" [Payment] : has
[Product] "1" -- "*" [Review] : receives
[User] "1" -- "*" [Order] : places

' --- Notes
note right of [ProductController]
  - Upload: Product images moved to public/images or storage depending on controller
  - Product model has accessor getImageUrlAttribute to resolve asset/storage/url
end note

note bottom
  Diagram auto-generated by analyzing controllers, models and views in the codebase.
  If you want different grouping (modules, admin vs public), tell me and I will adjust.
end note

@enduml